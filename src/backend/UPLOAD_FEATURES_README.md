# Upload Features Documentation\n\nThis document describes the new upload and mock draft features added to the Fantasy Football Draft Rankings system.\n\n## üöÄ New Features\n\n### 1. Custom Rankings Upload\nUpload your own CSV rankings files to use alongside FantasyPros rankings.\n\n### 2. Mock Draft Connection\nConnect to live Sleeper mock drafts for real-time draft tracking.\n\n## üìÅ Custom Rankings Upload\n\n### API Endpoints\n\n#### Upload Custom Rankings\n```http\nPOST /api/rankings/upload\nContent-Type: multipart/form-data\n\nParameters:\n- file: CSV file (required)\n- display_name: Human-readable name (optional)\n- description: Description of rankings (optional)\n- scoring_format: standard|half_ppr|ppr|custom (default: half_ppr)\n- league_type: standard|superflex|custom (default: standard)\n```\n\n#### Get Custom Rankings List\n```http\nGET /api/rankings/custom\n\nResponse:\n{\n  \"success\": true,\n  \"custom_rankings\": [\n    {\n      \"id\": \"custom_20250731_123456_my_rankings\",\n      \"display_name\": \"My Custom Rankings\",\n      \"description\": \"My personal 2025 rankings\",\n      \"filename\": \"custom_my_rankings_20250731_123456.csv\",\n      \"player_count\": 300,\n      \"scoring_format\": \"half_ppr\",\n      \"league_type\": \"standard\",\n      \"upload_time\": \"2025-07-31T12:34:56\",\n      \"exists\": true\n    }\n  ],\n  \"total_custom\": 1\n}\n```\n\n#### Delete Custom Rankings\n```http\nDELETE /api/rankings/custom/{file_id}\n\nResponse:\n{\n  \"success\": true,\n  \"message\": \"Deleted custom rankings successfully\"\n}\n```\n\n### CSV Format Requirements\n\n#### Required Columns\n- `name`: Player name (e.g., \"Josh Allen\")\n- `position`: Player position (QB, RB, WR, TE, K, DST/DEF)\n\n#### Optional Columns\n- `rank`: Overall ranking number\n- `tier`: Tier grouping\n- `team`: Team abbreviation\n\n#### Example CSV\n```csv\nname,position,rank,tier,team\nJosh Allen,QB,1,1,BUF\nChristian McCaffrey,RB,2,1,SF\nCooper Kupp,WR,3,1,LAR\nTravis Kelce,TE,4,1,KC\nJustin Tucker,K,5,2,BAL\nBuffalo Bills,DST,6,2,BUF\n```\n\n#### File Constraints\n- Format: CSV only\n- Size: Maximum 5MB\n- Players: 10-1000 recommended\n- Encoding: UTF-8\n\n### Storage\n- Files stored in: `backend/rankings/Custom/`\n- Metadata stored in: `backend/rankings/custom_rankings_metadata.json`\n- Filenames: `custom_{safe_name}_{timestamp}.csv`\n\n## üéØ Mock Draft Connection\n\n### API Endpoints\n\n#### Get Mock Draft Configuration\n```http\nGET /api/mock-draft/config\n\nResponse:\n{\n  \"success\": true,\n  \"config\": {\n    \"draft_id\": \"123456789\",\n    \"description\": \"My Mock Draft 2025\",\n    \"auto_refresh\": true,\n    \"refresh_interval\": 30,\n    \"created_at\": \"2025-07-31T12:34:56\",\n    \"is_active\": true\n  }\n}\n```\n\n#### Set Mock Draft Configuration\n```http\nPOST /api/mock-draft/config\nContent-Type: application/json\n\n{\n  \"draft_id\": \"123456789\",\n  \"description\": \"My Mock Draft 2025\",\n  \"auto_refresh\": true,\n  \"refresh_interval\": 30,\n  \"validate_draft\": true\n}\n```\n\n#### Get Mock Draft Status\n```http\nGET /api/mock-draft/status\n\nResponse:\n{\n  \"success\": true,\n  \"is_configured\": true,\n  \"config\": { /* config object */ },\n  \"draft_info\": {\n    \"status\": \"drafting\",\n    \"type\": \"snake\",\n    \"league_id\": \"987654321\"\n  },\n  \"drafted_players_count\": 45,\n  \"draft_status\": \"drafting\",\n  \"last_pick_time\": \"2025-07-31T12:45:00\"\n}\n```\n\n#### Clear Mock Draft Configuration\n```http\nDELETE /api/mock-draft/config\n\nResponse:\n{\n  \"success\": true,\n  \"message\": \"Mock draft configuration cleared successfully\"\n}\n```\n\n### Finding Your Draft ID\n\n1. Go to your Sleeper mock draft\n2. Look at the URL: `https://sleeper.app/draft/nfl/123456789`\n3. The Draft ID is the number at the end: `123456789`\n\n### Configuration Options\n\n- **draft_id**: Numeric Sleeper draft ID (required)\n- **description**: Human-readable description (optional)\n- **auto_refresh**: Enable automatic status updates (default: true)\n- **refresh_interval**: Update interval in seconds (5-300, default: 30)\n- **validate_draft**: Check if draft exists before saving (default: true)\n\n### Storage\n- Configuration stored in: `mock_draft_config.json`\n- Updates the main `draft_service.current_draft_id`\n\n## üõ†Ô∏è Integration with Existing System\n\n### Rankings Manager Integration\n\nThe `RankingsManager` class has been enhanced with:\n\n```python\n# Upload custom rankings\nresult = rankings_manager.upload_custom_rankings(\n    file_obj, display_name, description, scoring_format, league_type\n)\n\n# Get custom rankings list\ncustom_rankings = rankings_manager.get_custom_rankings_list()\n\n# Delete custom rankings\nresult = rankings_manager.delete_custom_rankings(file_id)\n\n# Load custom rankings\ndf = rankings_manager.get_rankings(custom_id=file_id)\n```\n\n### Draft Service Integration\n\nThe `DraftService` is automatically updated with the mock draft ID:\n\n```python\n# The draft service will use the configured mock draft ID\ndraft_service.current_draft_id = \"123456789\"\n```\n\n### Sleeper API Integration\n\nNew Sleeper API methods:\n\n```python\n# Get draft information\ndraft_info = SleeperAPI.get_draft_info(draft_id)\n\n# Get draft picks\npicks = SleeperAPI.get_draft_picks(draft_id)\n```\n\n## üß™ Testing\n\nRun the test suite to verify functionality:\n\n```bash\ncd backend\npython test_upload_features.py\n```\n\nThe test suite will:\n1. Check server health\n2. Upload a test CSV file\n3. Retrieve custom rankings list\n4. Configure mock draft settings\n5. Check mock draft status\n6. Clean up test data\n\n## üé® Frontend Components\n\n### FileUpload Component\n- Drag & drop CSV upload\n- Form validation\n- Progress indication\n- Format help\n\n### MockDraftConfig Component\n- Draft ID configuration\n- Live status monitoring\n- Auto-refresh settings\n- Configuration management\n\n### ManagementPanel Component\n- Tabbed interface\n- Custom rankings management\n- Mock draft configuration\n- Success/error messaging\n\n## üîß Configuration Files\n\n### Backend Files Added/Modified\n- `routes/upload_routes.py` - New upload endpoints\n- `services/sleeper_api.py` - Added draft methods\n- `app.py` - Registered upload blueprint\n- `test_upload_features.py` - Test suite\n\n### Frontend Files Added\n- `components/FileUpload.jsx` - File upload component\n- `components/FileUpload.css` - Upload styles\n- `components/MockDraftConfig.jsx` - Mock draft config\n- `components/MockDraftConfig.css` - Config styles\n- `components/ManagementPanel.jsx` - Combined interface\n- `components/ManagementPanel.css` - Panel styles\n\n## üö® Error Handling\n\nAll endpoints use the standardized error handling system:\n\n- **Validation Errors**: 400 with detailed field information\n- **Not Found Errors**: 404 with resource details\n- **External API Errors**: 503 with service information\n- **Internal Errors**: 500 with context tracking\n\n## üîí Security Considerations\n\n- File type validation (CSV only)\n- File size limits (5MB max)\n- Filename sanitization\n- Input validation for all parameters\n- No execution of uploaded content\n\n## üìä Monitoring\n\nError statistics available at `/api/error-stats` include:\n- Upload success/failure rates\n- Mock draft connection status\n- File validation errors\n- API response times\n\n## üöÄ Usage Examples\n\n### Upload Custom Rankings\n\n```javascript\nconst formData = new FormData();\nformData.append('file', csvFile);\nformData.append('display_name', 'My 2025 Rankings');\nformData.append('scoring_format', 'half_ppr');\nformData.append('league_type', 'superflex');\n\nconst response = await fetch('/api/rankings/upload', {\n  method: 'POST',\n  body: formData\n});\n```\n\n### Configure Mock Draft\n\n```javascript\nconst config = {\n  draft_id: '123456789',\n  description: 'My Mock Draft',\n  auto_refresh: true,\n  refresh_interval: 30\n};\n\nconst response = await fetch('/api/mock-draft/config', {\n  method: 'POST',\n  headers: { 'Content-Type': 'application/json' },\n  body: JSON.stringify(config)\n});\n```\n\n## üéØ Next Steps\n\n1. **Integration**: Add the `ManagementPanel` component to your main app\n2. **Styling**: Customize CSS to match your design system\n3. **Features**: Consider adding ranking comparison tools\n4. **Analytics**: Track usage patterns and popular formats\n5. **Automation**: Add scheduled ranking updates\n\n## üìû Support\n\nFor issues or questions:\n1. Check the test suite output\n2. Review browser console for frontend errors\n3. Check backend logs for API errors\n4. Verify file formats and sizes\n5. Ensure Sleeper draft IDs are valid\n\n---\n\n**Note**: This system is designed for mock drafts only. Live league drafts should use the existing league-based functionality.